:icons: font
ifdef::env-github[]
:tip-caption: :bulb:
:note-caption: :information_source:
:important-caption: :heavy_exclamation_mark:
:caution-caption: :fire:
:warning-caption: :warning:
endif::[]
== Example example_resolved-modules

Part of the full xref:../../README.adoc[Java 9 Jigsaw modules example] suite.

[IMPORTANT]
.Authors
====
Originally written by https://github.com/mrtnlhmnn[Martin Lehmann], https://github.com/kristines[Kristine Schaal] and https://github.com/rgrammes[RÃ¼diger Grammes] (cf. https://github.com/accso/java9-jigsaw-examples[original repository]).

Migrated for JPMS support documentation of Apache Maven^TM^ in the course of the https://open-elements.com/support-care-maven/[Maven Support & Care] program by https://github.com/ascheman[Gerd Aschemann] (and other team members) as https://github.com/support-and-care/java9-jigsaw-examples[forked repository].
Please add discussions, requirements, bugfixes, etc. to the fork instead of the original.
====

== What is this example about?

=== Modules in this example

* TODO
* modmain has a Main class which is started in run.sh

=== Module Dependency Graph, created with https://github.com/accso/java9-jigsaw-depvis[DepVis]

image::moduledependencies.png[Example's Module Dependency Graph]

=== Example shows ...

.TBD
----
Example for

* resolvedmods: What is loaded?

Modules moda, modb (requires moda), modc

The Main method in each module outputs the modules in the boot layer:

* moda/pkga.AMain: The boot layer contains java., jdk. and moda
* modb/pkgB.BMain: The boot layer contains java., jdk., moda, modb
* modc/pkgC.CMain: The boot layer contains java., jdk., modc
* modb/pkgb.BMain with --add-modules modc: The boot layer contains java., jdk., moda, modb, modc

Although only java.base is required, some java.* modules are loaded (java.rmi, java.scripting, java.logging, ...)

An automatic module is only loaded if it is also required.
First the configuration is created based on the required relationships, then the read edges for automatic modules are added.

See also "State of the Module System":

*After* a module graph is resolved, therefore, an automatic module
is made to read every other named module, whether automatic or explicit.
----
=== Output

This example uses xref:../../README.adoc#golden-master-testing[golden master testing] to ensure output consistency.
The expected output is compared with actual output using `verify.sh`.

==== Expected Output

[source]
----
include::expected-result/run.txt[]
----

==== Actual Output

[source]
----
include::run-result/run.txt[]
----

==== Maven 4 Output

[source]
----
include::m4/run-result/run.txt[]
----

== Maven 4 Migration

This example has been migrated to Maven 4 using the standard Module Source Hierarchy approach.

=== Key Characteristics

Multiple Modules::
This example compiles three modules (`moda`, `modb`, `modc`) demonstrating module resolution, not a single `modmain` module.
+
The `pom.xml` defines all three modules in the `<sources>` section.

Multi-Scenario Testing::
The `m4/run.sh` script executes 8 different module resolution scenarios.
+
. Running with root module `moda` (standalone)
. Running with root module `modb` (requires `moda`)
. Running with root module `modc` (standalone)
. Running with root module `modb` plus `--add-modules modc`
. Running with root module `modb` plus automatic module `javax.json` (from `../amlib`)
. Running with root module `modb` plus `--limit-modules`
. Running with root module `modb` plus `--limit-modules` on specific JDK modules
. Using `jlink` to create a custom runtime image with `modb`, then running from that image

jlink Integration::
Scenario 8 demonstrates creating a custom runtime image using `jlink`.
+
* Creates minimal runtime with only required modules
* Demonstrates `jlink --module-path` with both application modules and JDK modules
* Runs the application from the linked runtime image

Automatic Module Reference::
The run script references `../amlib` for the `javax.json` automatic module in scenario 5, demonstrating that automatic modules are only loaded when explicitly required or added.
